
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->

<head>


<meta charset="utf-8">
<meta http-equiv="cleartype" content="on">

<title>Getting Started Fullstack: Building API With Baucis - Fullstack Development w/ Javascript</title>
<meta name="author" content="Emre Guneyler">




<meta name="description" content="Blog about javascript, nodejs, emberjs, backbone, requirejs, yeoman, phaser, web development, game development, and anything that interests me about &hellip;">

<meta name="keywords" content="baucis mongodb mongoose nodejs javascript nodejs emberjs backbone phaser requirejs yeoman web-development game-development">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Twitter Cards -->

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="/images/diary-bg20.jpg"
  
  <meta name="twitter:title" content="Getting Started Fullstack: Building API with Baucis">
  <meta name="twitter:description" content="Blog about javascript, nodejs, emberjs, backbone, requirejs, yeoman, phaser, web development, game development, and anything that interests me about &hellip;">
  <meta name="twitter:creator" content="@eguneys">


<!-- Open Graph -->
<meta property="og:local" content="en_US">
<meta property="og:type" content="article">
<meta property="og:url" content="http://www.eguneys.com/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis">
<meta property="og:title" content="Getting Started Fullstack: Building API with Baucis">
<meta property="og:description" content="Blog about javascript, nodejs, emberjs, backbone, requirejs, yeoman, phaser, web development, game development, and anything that interests me about &hellip;">

  <meta property="og:image" content="/images/diary-bg20.jpg">

<meta property="og:site_name" content="Fullstack Development w/ Javascript">

<link rel="canonical" href="http://www.eguneys.com/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis">
<link href="/favicon.png" rel="icon">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/atom.xml" rel="alternate" title="Fullstack Development w/ Javascript" type="application/atom+xml">

<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>
<script>Modernizr || document.write('<script src="/javascripts/vendor/modernizr-2.6.2.custom.min.js"><\/script>') </script>


  
      
  

  
    
  

  <style type="text/css">body {background-image:url(/images/colorflags-bg.jpg);}</style>


<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">


</head>

<body id="post" class="feature">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="/">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Emre Guneyler photo" class="author-photo">
					<h4>Emre Guneyler</h4>
					<p>Fullstack Hipster</p>
				</li>
				<li><a href="/about">Learn More</a></li>-
				
				<li>
					<a href="http://twitter.com/eguneys"><i class="fa fa-twitter"></i> Twitter</a>
				</li>
				<li>
					<a href="http://plus.google.com/eguneys"><i class="fa fa-google-plus"></i> Google+</a>
				</li>
				<li>
					<a href="http://github.com/eguneys"><i class="fa fa-github"></i> GitHub</a>
				</li>
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/posts/">All Posts</a></li>
				<li><a href="/categories/">All Categories</a></li>
			</ul>
		</li>
		<li><a href="http://jsgamesonline.com">JS Games</a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->


<nav class="lang-switch" role="navigation">
  <a href="/">EN</a>
  <a href="/tr">TR</a>
</nav>
      



<div class="entry-header">
  
  <div class="entry-image">
    <img src="/images/diary-bg20.jpg" alt="Getting Started Fullstack: Building API with Baucis">
  </div><!-- /.entry-image -->
</div><!-- /.entry-header -->


<div id="main" role="main">
  <article class="hentry">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title"><a href="/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis/" rel="bookmark" title="Getting Started Fullstack: Building API with Baucis">Getting Started Fullstack: Building API with Baucis</a></h1>
        
        <h2>January 06, 2014</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content">
      <p>In previous post, we&rsquo;ve seen how to navigate in our site using
backbone.js. In this post, we will go back to server side, and build
our blog api using <a href="https://github.com/wprl/baucis">baucis</a>. At the
end of this tutorial, you will be able to query your mongodb database
and pull blog information.</p>

<h1>Building Schemas with Mongoose</h1>

<p>Firstly, let&rsquo;s define our blog schema. We will use
<a href="http://mongoosejs.com">mongoose</a> to interact with mongodb. Go to
app/scripts directory and create a new file named schemas.js.</p>

<p><em>app/scripts/schemas.js</em></p>

<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mongoose&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">baucis</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;baucis&#39;</span><span class="p">);</span>

<span class="c1">// Define journal schema</span>
<span class="kd">var</span> <span class="nx">journalSchema</span> <span class="o">=</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">Schema</span><span class="p">({</span>
    <span class="nx">paper</span><span class="o">:</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span> <span class="nx">url</span><span class="o">:</span> <span class="nb">String</span><span class="p">},</span>
    <span class="nx">author</span><span class="o">:</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span> <span class="nx">photo</span><span class="o">:</span> <span class="nb">String</span> <span class="p">},</span>
    <span class="nx">title</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">body</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">date</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nb">Date</span><span class="p">,</span> <span class="k">default</span><span class="o">:</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">},</span>
    <span class="nx">meta</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">votes</span><span class="o">:</span> <span class="nb">Number</span><span class="p">,</span>
        <span class="nx">favs</span><span class="o">:</span> <span class="nb">Number</span><span class="p">,</span>
        <span class="nx">tags</span><span class="o">:</span> <span class="p">{</span> <span class="nx">type</span><span class="o">:</span> <span class="nb">String</span><span class="p">,</span> <span class="nx">lowercase</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">trim</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// db connection string</span>
<span class="kd">var</span> <span class="nx">MONGO_URI</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGOHQ_URI</span> <span class="o">||</span> <span class="s1">&#39;mongodb://localhost/test&#39;</span><span class="p">;</span>


<span class="c1">// connect to mongodb with mongoose</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">MONGO_URI</span><span class="p">);</span>

<span class="c1">// define a journal model with journalSchema</span>
<span class="nx">mongoose</span><span class="p">.</span><span class="nx">model</span><span class="p">(</span><span class="s1">&#39;journal&#39;</span><span class="p">,</span> <span class="nx">journalSchema</span><span class="p">);</span>

<span class="c1">// use baucis to create a rest api</span>
<span class="kd">var</span> <span class="nx">controller</span> <span class="o">=</span> <span class="nx">baucis</span><span class="p">.</span><span class="nx">rest</span><span class="p">(</span><span class="s1">&#39;journal&#39;</span><span class="p">);</span></code></pre></div>


<p>We created a blog schema, connected to our database, defined a model
based on our schema, and finally used baucis to create the rest api.
Now if you run your server, your api will be available at:</p>

<p>*<a href="http://localhost/api*">http://localhost/api*</a> endpoint.</p>

<p>Here is a table, describing available functions:</p>

<table>
<thead>
<tr>
<th> HTTP Verb     </th>
<th> /journals   </th>
<th> /journals/:id </th>
</tr>
</thead>
<tbody>
<tr>
<td> GET           </td>
<td> Get all or a subset of documents </td>
<td> Get the addressed document </td>
</tr>
<tr>
<td> POST          </td>
<td> Creates new documents and sends them back.  You may post a single document or an array of documents.      </td>
<td> n/a </td>
</tr>
<tr>
<td> PUT           </td>
<td> n/a </td>
<td> Update the addressed document </td>
</tr>
<tr>
<td> DELETE        </td>
<td> Delete all or a subset of documents </td>
<td> Delete the addressed object </td>
</tr>
</tbody>
</table>


<p>To test it go to *<a href="http://localhost/api/journals*">http://localhost/api/journals*</a> in your browser, it
should return an empty array. Because we don&rsquo;t have any blogs in our
database yet.</p>

<h1>Using Mongo Shell</h1>

<p>Though we can post blogs to our database using the api, we will simply
create blogs using the mongo shell. Mongo shell is CLI for using
mongodb. run <em>mongo</em> in your console to open the shell. Issue the
following commands to create your first blog entry.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># This is for commenting</span>
   <span class="c"># just ignore it.</span>

   <span class="c"># List databases</span>
   show dbs
   
   <span class="c"># Choose database, test</span>
   use <span class="nb">test</span>

   <span class="c"># List collections in the database</span>
   show collections

   <span class="c"># journals collection is created when we created a model with mongoose.</span>
   <span class="c"># collection is the plural form of our model.</span>

   <span class="c">#list the contents in journals collection</span>
   <span class="c"># it should be empty</span>
   db.journals.find<span class="o">()</span>

   <span class="c"># place a new blog entry in journals collection</span>
   <span class="c"># here we define only title and body attributes, you can define other attributes as well</span>

   db.journals.create<span class="o">({</span>title: <span class="s1">&#39;My Simple Blog 1&#39;</span>, body: <span class="s1">&#39;Simple body for testing&#39;</span> <span class="o">})</span>

   <span class="c"># list the contents again to see the newly created blog</span>
   db.journals.find<span class="o">()</span></code></pre></div>


<p>Mongo shell is interpreting javascript code here, so use
javascript. Undefined attributes will have their defaults value We can
disable null values for attributes, but for simplicity we don&rsquo;t.</p>

<p>Now go to <a href="http://localhost/api/journals">http://localhost/api/journals</a> again and see the newly created blog entry.</p>

<blockquote><p>In the next post, we will consume this api with backbone.js and list
the blogs in our main page.</p></blockquote>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/categories/#baucis" title="Pages tagged baucis" class="tag">baucis</a><a href="/categories/#mongodb" title="Pages tagged mongodb" class="tag">mongodb</a><a href="/categories/#mongoose" title="Pages tagged mongoose" class="tag">mongoose</a><a href="/categories/#nodejs" title="Pages tagged nodejs" class="tag">nodejs</a></span>
        <span><a href="/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis/" rel="bookmark" title="Getting Started Fullstack: Building API with Baucis">Getting Started Fullstack: Building API with Baucis</a> was published on <span class="entry-date date published updated"><time datetime="2014-01-06T11:52:06+02:00">January 06, 2014</time></span></span>
        
        <span class="author vcard"><span class="fn"><a href="" title="About Emre Guneyler">Emre Guneyler</a></span></span>
        <div class="social-share">
          <ul class="socialcount socialcount-small inline-list">
            <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
            <li class="twitter"><a href="https://twitter.com/intent/tweet?text=/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
            <li class="googleplus"><a href="https://plus.google.com/share?url=/blog/2014/01/06/getting-started-fullstack-building-api-with-baucis/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
          </ul>
        </div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    
      <div class="read-more">
        
          <div class="read-more-header">
            <a href="/tr/blog/2014/10/09/hayat-hikayem/" class="btn">Read More</a>
          </div><!-- /.read-more-header -->
          <div class="read-more-content">
            <h3><a href="/tr/blog/2014/10/09/hayat-hikayem/" title="Hayat Hikayem">Hayat Hikayem</a></h3>
            <p>## Hayat HikayemHer çocuk özel olduğunu düşünür, dünyada bir fark yaratacaklarını. Eh,bende öyle düşünmüştüm. Benim durumumda gerçekten &hellip;&hellip; <a href="/tr/blog/2014/10/09/hayat-hikayem/"> Continue reading</a></p>
          </div><!-- /.read-more-content -->
        
        <div class="read-more-list">
          
            <div class="list-item">
              <h4><a href="/blog/2014/09/17/building-a-voting-app-front-end-slash-w-ember/" title="Building a Voting App: Front-end /w ember">Building a Voting App: Front-end /w ember</a></h4>
              <span>Published on September 17, 2014</span>
            </div><!-- /.list-item -->
          
            <div class="list-item">
              <h4><a href="/blog/2014/09/17/building-a-voting-app-rest-api-slash-w-sequelize/" title="Building a Voting App: REST API /w Sequelize">Building a Voting App: REST API /w Sequelize</a></h4>
              <span>Published on September 17, 2014</span>
            </div><!-- /.list-item -->
          
        </div><!-- /.read-more-list -->
      </div><!-- /.read-more -->
    
    
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2015 Emre Guneyler. Powered by <a href="http://octopress.org">Octopress</a> using the <a href="https://github.com/Z1MM32M4N/hpstr-theme/">HPSTR Theme for Octopress</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->


	        
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/javascripts/vendor/jquery-1.9.1.min.js"><\/script>')</script>

<script src="/javascripts/octopress.js" type="text/javascript"></script>

<script src="/javascripts/scripts.min.js"></script>

  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-42906606-6']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



	        

</body>
</html>
